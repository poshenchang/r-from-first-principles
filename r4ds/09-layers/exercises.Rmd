---
title: "exercises"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
```

## Section 9.2 exercises

1.  Create a scatterplot of `hwy` vs. `displ` where the points are pink filled in triangles.\
    A: 
    ```{r}
    mpg |> 
      ggplot(aes(x = displ, y = hwy)) +
      geom_point(color = "pink", shape = 2)
    ```

2.  Why did the following code not result in a plot with blue points?

    ```{r}
    #| fig-alt: |
    #|   Scatterplot of highway fuel efficiency versus engine size of cars  
    #|   that shows a negative association. All points are red and 
    #|   the legend shows a red point that is mapped to the word blue.
    ggplot(mpg) + 
      geom_point(aes(x = displ, y = hwy, color = "blue"))
    ```
    
    A: `ggplot()` interprets the `"blue"` as data instead of a color, hence it maps the categorical value `"blue"` to a color from the default palette (in this case red). The correct way to make points blue is the following.
    ```{r}
    ggplot(mpg) + 
      geom_point(aes(x = displ, y = hwy), color = "blue")
    ```

3.  What does the `stroke` aesthetic do?
    What shapes does it work with?
    (Hint: use `?geom_point`)\
    A: It controls the width of the outline of filled shapes (21-25).

4.  What happens if you map an aesthetic to something other than a variable name, like `aes(color = displ < 5)`?
    Note, you'll also need to specify x and y.\
    A: Since `displ < 5` is a boolean expression, `ggplot()` recognizes it as a categorical variable with values determined by its evaluation.
    ```{r}
    ggplot(mpg) + 
      geom_point(aes(x = displ, y = hwy, color = displ < 5))
    ```

## Section 9.3 exercises

1.  What geom would you use to draw a line chart?
    A boxplot?
    A histogram?
    An area chart?\
    A: `geom_line()`, `geom_boxplot()`, `geom_histogram()` and `geom_area()`.

2.  Earlier in this chapter we used `show.legend` without explaining it:

    ```{r}
    #| fig-show: hide
    #| message: false
    ggplot(mpg, aes(x = displ, y = hwy)) +
      geom_smooth(aes(color = drv), show.legend = FALSE)
    ```

    What does `show.legend = FALSE` do here?
    What happens if you remove it?
    Why do you think we used it earlier?\
    A: It hides the legend of the plot.

3.  What does the `se` argument to `geom_smooth()` do?\
    A: It displays a shaded confidence region around the line.

4.  Recreate the R code necessary to generate the following graphs.
    Note that wherever a categorical variable is used in the plot, it's `drv`.

    ```{r}
    ggplot(mpg, aes(x = displ, y = hwy)) + 
      geom_point() + 
      geom_smooth(se = FALSE)
    ggplot(mpg, aes(x = displ, y = hwy)) + 
      geom_smooth(aes(group = drv), se = FALSE) +
      geom_point()
    ggplot(mpg, aes(x = displ, y = hwy, color = drv)) + 
      geom_point() + 
      geom_smooth(se = FALSE)
    ggplot(mpg, aes(x = displ, y = hwy)) + 
      geom_point(aes(color = drv)) + 
      geom_smooth(se = FALSE)
    ggplot(mpg, aes(x = displ, y = hwy)) + 
      geom_point(aes(color = drv)) +
      geom_smooth(aes(linetype = drv), se = FALSE)
    ggplot(mpg, aes(x = displ, y = hwy)) + 
      geom_point(size = 4, color = "white") + 
      geom_point(aes(color = drv))
    ```

## Section 9.4 exercises

1.  What happens if you facet on a continuous variable?\
    A: `ggplot()` treats it as a categorical variable (separate facet for each value).
    ```{r}
    ggplot(mpg, aes(x = displ, y = hwy)) + 
      geom_point() +
      facet_wrap(~hwy)
    ```

2.  What do the empty cells in the plot above with `facet_grid(drv ~ cyl)` mean?
    Run the following code.
    How do they relate to the resulting plot?\
    A: Empty grids indicate that no observation of this particular combination of values exist. 

    ```{r}
    ggplot(mpg) + 
      geom_point(aes(x = drv, y = cyl))
    ```

3.  What plots does the following code make?
    What does `.` do?\
    A: a dummy variable if one only wants to facet along one variable.

    ```{r}
    ggplot(mpg) + 
      geom_point(aes(x = displ, y = hwy)) +
      facet_grid(drv ~ .)

    ggplot(mpg) + 
      geom_point(aes(x = displ, y = hwy)) +
      facet_grid(. ~ cyl)
    ```

4.  Take the first faceted plot in this section:

    ```{r}
    ggplot(mpg) + 
      geom_point(aes(x = displ, y = hwy)) + 
      facet_wrap(~ cyl, nrow = 2)
    ```

    What are the advantages to using faceting instead of the color aesthetic?
    What are the disadvantages?
    How might the balance change if you had a larger dataset?\
    A: faceting makes it easier to isolate out data within each facet, but makes it harder to compare across different facets.

5.  Read `?facet_wrap`.
    What does `nrow` do?
    What does `ncol` do?
    What other options control the layout of the individual panels?
    Why doesn't `facet_grid()` have `nrow` and `ncol` arguments?\
    A: the number of rows and columns of `facet_grid()` in determined by the number of categorical variables assigned.

6.  Which of the following plots makes it easier to compare engine size (`displ`) across cars with different drive trains?
    What does this say about when to place a faceting variable across rows or columns?\
    A: histograms naturally works better with faceting across rows.

    ```{r}
    #| message: false
    ggplot(mpg, aes(x = displ)) + 
      geom_histogram() + 
      facet_grid(drv ~ .)

    ggplot(mpg, aes(x = displ)) + 
      geom_histogram() +
      facet_grid(. ~ drv)
    ```

7.  Recreate the following plot using `facet_wrap()` instead of `facet_grid()`.
    How do the positions of the facet labels change?

    ```{r}
    ggplot(mpg) + 
      geom_point(aes(x = displ, y = hwy)) +
      facet_grid(drv ~ .)
    ```
    
    A: The facet labels move to the top side.
    ```{r}
    ggplot(mpg) + 
      geom_point(aes(x = displ, y = hwy)) +
      facet_wrap(~drv, ncol = 1)
    ```

## Section 9.5 exercises

1.  What is the default geom associated with `stat_summary()`?
    How could you rewrite the previous plot to use that geom function instead of the stat function?\
    A: the default geom is `geom_pointrange()`.
    ```{r}
    diamonds |> 
      group_by(cut) |> 
      summarise(
        y = mean(depth),
        ymin = min(depth),
        ymax = max(depth)
      ) |> 
      ggplot(aes(x = cut, y = y, ymin = ymin, ymax = ymax)) +
      geom_pointrange()
    ```

2.  What does `geom_col()` do?
    How is it different from `geom_bar()`?\
    A: the heights of the bars in `geom_col()` represents the values in the data, and it uses `stat_identity` by default.

3.  Most geoms and stats come in pairs that are almost always used in concert.
    Make a list of all the pairs.
    What do they have in common?
    (Hint: Read through the documentation.)

4.  What variables does `stat_smooth()` compute?
    What arguments control its behavior?\
    A: `stat_smooth()` computes the following variables:
    * `after_stat(y)` or `after_stat(x)`:
    Predicted value.
    
    * `after_stat(ymin) or `after_stat(xmin)`:
    Lower pointwise confidence band around the mean.
    
    * `after_stat(ymax)` or `after_stat(xmax)`:
    Upper pointwise confidence band around the mean.
    
    * `after_stat(se)`:
    Standard error.

5.  In our proportion bar chart, we needed to set `group = 1`.
    Why?
    In other words, what is the problem with these two graphs?\
    A: Without explicit declaration, `ggplot()` assumes that `group = cut`. Under this logic, the stat `prop` is computed within each cut, hence every bar has height 1. Setting `group = 1` is just a way to group the entire dataset together.

    ```{r}
    ggplot(diamonds, aes(x = cut, y = after_stat(prop))) + 
      geom_bar()
    ggplot(diamonds, aes(x = cut, fill = color, y = after_stat(prop))) + 
      geom_bar()
    ```

## Section 9.6 exercises

1.  What is the problem with the following plot?
    How could you improve it?

    ```{r}
    ggplot(mpg, aes(x = cty, y = hwy)) + 
      geom_point()
    ```
    
    A: The underlying data are rounded to intergers, hence multiple points overlap each other. Applying some randomness using `geom_jitter()` helps with the overall plotting.
    ```{r}
    ggplot(mpg, aes(x = cty, y = hwy)) + 
      geom_jitter()
    ```

2.  What, if anything, is the difference between the two plots?
    Why?

    ```{r}
    ggplot(mpg, aes(x = displ, y = hwy)) +
      geom_point()
    ggplot(mpg, aes(x = displ, y = hwy)) +
      geom_point(position = "identity")
    ```
    
    A: The plots are identical since the default value for the argument `position` in `geom_point()` is `"identity"`.

3.  What parameters to `geom_jitter()` control the amount of jittering?\
    A: `width` and `height` control the amount of horizontal and vertical jitter, respectively.

4.  Compare and contrast `geom_jitter()` with `geom_count()`.\
    A: `geom_jitter()` solves overplotting by adding randomness, while `geom_count()` solves this by adjusting point sizes.
    ```{r}
    ggplot(mpg, aes(x = cty, y = hwy)) + 
      geom_jitter()
    ggplot(mpg, aes(x = cty, y = hwy)) + 
      geom_count()
    ```

5.  What's the default position adjustment for `geom_boxplot()`?
    Create a visualization of the `mpg` dataset that demonstrates it.\
    A: The default position adjustment is `dodge2`.
    ```{r}
    ggplot(mpg, aes(x = drv, y = cty, fill = class)) + 
      geom_boxplot()
    ```

## Section 9.7 exercises

1.  Turn a stacked bar chart into a pie chart using `coord_polar()`.\
    A: 
    ```{r}
    ggplot(diamonds, aes(x = "", fill = cut)) +
      geom_bar(width = 1) +
      coord_polar(theta = "y")
    ```

2.  What's the difference between `coord_quickmap()` and `coord_map()`?\
    A: `coord_map()` uses true map projection and transforms each point mathematically. `coord_quickmap()` assumes a small rectangular region and only rescale among the axes.

3.  What does the following plot tell you about the relationship between city and highway mpg?
    Why is `coord_fixed()` important?
    What does `geom_abline()` do?

    ```{r}
    ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) +
      geom_point() + 
      geom_abline() +
      coord_fixed()
    ```
    
    A: `coord_fixed()` maintains a specific ratio between the axes. `geom_abline` adds a reference diagonal marking the line where `x = y`. The plot demonstrates that `hwy` is always larger than `cty`.
